## L 2.1

### Задача
* Паттерн «Посетитель».

### Комментарий
Посетитель позволяет определить операцию, выполняемую над элементами структуры объекта, не изменяя классы этих элементов. 
Посетитель позволяет добавить новую операцию, не изменяя классы элементов, над которыми эта операция выполняется.
Когда использовать:
Когда нужно выполнить операцию над объектами сложной структуры объектов.
Когда классы, составляющие структуру объектов, редко изменяются, но часто добавляются новые операции над этой структурой.
в сложной программе.
* Преимущества использования шаблона проектирования Посетитель:
  - Если логика работы изменится, то нам нужно будет внести изменения только в реализацию посетителя, а не во все классы элементов.
  - Добавить новый элемент в систему легко, для этого потребуется внести изменения только в интерфейс посетителя и 
  реализацию, а существующие классы элементов не будут затронуты.
* Минусы использования шаблона проектирования Посетитель:
  - На этапе проектирования нам следует знать тип возвращаемого значения методов visit(), в противном случае нам придется изменить интерфейс и все его реализации.
  - Если реализаций интерфейса посетителя слишком много, его трудно расширять.
  - 
* Реальные примеры использования паттерна Посетитель:

В моей реализации ITaxi объявляет операцию для каждого контрентого элемнта (человка, животного багажа). Имя и сигнатура 
операции идентифицируют структуру, которая отправляет запрос Visit посетителю. Это позволяет посетителю определить 
конкретный класс посещаемого элемента. Затем посетитель может получить доступ к элементам напрямую через его определенный интерфейс.
Taxi реализуют каждую операцию, объявленную ITaxi. Transportable определяет операцию Accept, которая принимает посетителя в качестве аргумента.
Person, Animal и Luggage реализуют операцию Accept, которая принимает ITaxi в качестве аргумента.



https://refactoring.guru/design-patterns/visitor
https://sourcemaking.com/design_patterns/visitor
https://www.opencodez.com/java/visitor-design-pattern.htm
https://touch.ethz.ch/visitor.pdf
https://stackoverflow.com/questions/2604169/visitor-patterns-purpose-with-examples
https://mydesignpatterns.wordpress.com/2009/03/20/visitor-design-pattern/

Последствия
Посетитель позволяет определить новую операцию, не изменяя классы элементов, с которыми она работает.
Шаблон «Посетитель» — классический метод восстановления утерянной информации о типах без использования динамических приведений.
Двойная диспетчеризация. При «двойной диспетчеризации» выполняемая операция зависит от: имени запроса и типа ДВУХ получателей (типа Посетителя и типа элемента, который он посещает).

Недостатки
Visitor не подходит для ситуации, когда «посещаемые» классы нестабильны. Каждый раз, когда добавляется новый производный класс иерархии Composite, каждый производный класс Visitor должен быть изменен.
Подпись методов посетителя должна быть известна заранее.
Необходимо написать много кода, чтобы подготовить использование посетителей.
Если иерархия ObjectStructure не может быть изменена, поскольку вам это не разрешено, шаблон посетителя вообще не может быть применен.
Вам, возможно, придется пойти на компромисс с инкапсуляцией, поскольку придется раскрыть слишком много внутренних компонентов класса Element, чтобы сделать классы Element «готовыми к посещению».
При чрезмерном использовании это может привести к увеличению нежелательной связанности в нашем приложении по сравнению с решением, в котором мы просто использовали полиморфизм; т. е. элементы происходят от абстрактного базового класса, и каждый элемент переопределяет методы «операции».
Данные, собранные при обходе дерева, должны храниться у посетителя.